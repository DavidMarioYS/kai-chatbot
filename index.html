<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kai - Your Daily AI Companion</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const GROQ_API_KEY = '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';
        const GROQ_API_URL = 'https://api.groq.com/openai/v1/chat/completions';

        // ============================================
        // LANGUAGE DATA
        // ============================================
        
        const LANGUAGES = {
            'id': { name: 'Indonesia', flag: 'üáÆüá©' },
            'en': { name: 'English', flag: 'üá¨üáß' },
            'zh': { name: '‰∏≠Êñá (Chinese)', flag: 'üá®üá≥' },
            'ja': { name: 'Êó•Êú¨Ë™û (Japanese)', flag: 'üáØüáµ' },
            'ko': { name: 'ÌïúÍµ≠Ïñ¥ (Korean)', flag: 'üá∞üá∑' },
            'ar': { name: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Arabic)', flag: 'üá∏üá¶' },
            'es': { name: 'Espa√±ol (Spanish)', flag: 'üá™üá∏' },
            'fr': { name: 'Fran√ßais (French)', flag: 'üá´üá∑' },
            'de': { name: 'Deutsch (German)', flag: 'üá©üá™' },
            'ru': { name: '–†—É—Å—Å–∫–∏–π (Russian)', flag: 'üá∑üá∫' },
            'pt': { name: 'Portugu√™s (Portuguese)', flag: 'üáµüáπ' },
            'hi': { name: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)', flag: 'üáÆüá≥' },
            'th': { name: '‡πÑ‡∏ó‡∏¢ (Thai)', flag: 'üáπüá≠' },
            'vi': { name: 'Ti·∫øng Vi·ªát (Vietnamese)', flag: 'üáªüá≥' },
            'it': { name: 'Italiano (Italian)', flag: 'üáÆüáπ' },
            'nl': { name: 'Nederlands (Dutch)', flag: 'üá≥üá±' },
        };

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        
        const getCurrentTime = () => {
            const now = new Date();
            return {
                time: now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit', second: '2-digit' }),
                hour: now.getHours(),
                minute: now.getMinutes(),
                greeting: now.getHours() < 12 ? 'pagi' : now.getHours() < 15 ? 'siang' : now.getHours() < 18 ? 'sore' : 'malam'
            };
        };

        const getCurrentDate = () => {
            const now = new Date();
            return {
                date: now.toLocaleDateString('id-ID', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' }),
                dayName: now.toLocaleDateString('id-ID', { weekday: 'long' }),
                day: now.getDate(),
                month: now.getMonth() + 1,
                year: now.getFullYear(),
                isoDate: now.toISOString().split('T')[0]
            };
        };

        const timeToMinutes = (timeStr) => {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        };

        const getScheduleStatus = (schedule) => {
            const now = new Date();
            const scheduleDate = new Date(schedule.date);
            const [hours, minutes] = schedule.time.split(':').map(Number);
            scheduleDate.setHours(hours, minutes, 0);

            const duration = schedule.duration || 60;
            const endTime = new Date(scheduleDate.getTime() + duration * 60000);

            if (now > endTime) {
                return 'expired';
            } else if (now >= scheduleDate && now <= endTime) {
                return 'ongoing';
            } else {
                return 'upcoming';
            }
        };

        // ============================================
        // TRANSLATOR MODAL
        // ============================================
        
        function TranslatorModal({ isOpen, onClose }) {
            const [sourceText, setSourceText] = useState('');
            const [translatedText, setTranslatedText] = useState('');
            const [sourceLang, setSourceLang] = useState('auto');
            const [targetLang, setTargetLang] = useState('en');
            const [isTranslating, setIsTranslating] = useState(false);

            const handleTranslate = async () => {
                if (!sourceText.trim()) return;
                
                setIsTranslating(true);
                
                const prompt = sourceLang === 'auto' 
                    ? `Detect the language of this text and translate it to ${LANGUAGES[targetLang]?.name || 'English'}. Only provide the translation without any explanation:\n\n${sourceText}`
                    : `Translate this text from ${LANGUAGES[sourceLang]?.name} to ${LANGUAGES[targetLang]?.name}. Only provide the translation without any explanation:\n\n${sourceText}`;

                try {
                    const response = await fetch(GROQ_API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${GROQ_API_KEY}`
                        },
                        body: JSON.stringify({
                            model: 'llama-3.3-70b-versatile',
                            messages: [
                                { role: 'user', content: prompt }
                            ],
                            temperature: 0.3,
                            max_tokens: 1000
                        })
                    });

                    const data = await response.json();
                    setTranslatedText(data.choices[0].message.content);
                } catch (error) {
                    setTranslatedText(`‚ùå Error: ${error.message}`);
                }
                
                setIsTranslating(false);
            };

            const swapLanguages = () => {
                if (sourceLang !== 'auto') {
                    const temp = sourceLang;
                    setSourceLang(targetLang);
                    setTargetLang(temp);
                    setSourceText(translatedText);
                    setTranslatedText(sourceText);
                }
            };

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text);
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div className="sticky top-0 bg-gradient-to-r from-purple-500 to-pink-600 text-white p-6 rounded-t-2xl">
                            <div className="flex items-center justify-between">
                                <h2 className="text-2xl font-bold flex items-center gap-2">
                                    üåç Translator
                                </h2>
                                <button onClick={onClose} className="text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2">
                                    ‚úï
                                </button>
                            </div>
                        </div>

                        <div className="p-6">
                            <div className="flex items-center justify-center gap-4 mb-4">
                                <select
                                    value={sourceLang}
                                    onChange={(e) => setSourceLang(e.target.value)}
                                    className="px-4 py-2 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
                                >
                                    <option value="auto">üîç Auto Detect</option>
                                    {Object.entries(LANGUAGES).map(([code, lang]) => (
                                        <option key={code} value={code}>
                                            {lang.flag} {lang.name}
                                        </option>
                                    ))}
                                </select>

                                <button
                                    onClick={swapLanguages}
                                    disabled={sourceLang === 'auto'}
                                    className="p-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed"
                                    title="Swap Languages"
                                >
                                    üîÑ
                                </button>

                                <select
                                    value={targetLang}
                                    onChange={(e) => setTargetLang(e.target.value)}
                                    className="px-4 py-2 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
                                >
                                    {Object.entries(LANGUAGES).map(([code, lang]) => (
                                        <option key={code} value={code}>
                                            {lang.flag} {lang.name}
                                        </option>
                                    ))}
                                </select>
                            </div>

                            <div className="grid md:grid-cols-2 gap-4">
                                <div>
                                    <div className="flex justify-between items-center mb-2">
                                        <label className="text-sm font-semibold text-gray-700">
                                            Source Text
                                        </label>
                                        <span className="text-xs text-gray-500">
                                            {sourceText.length} characters
                                        </span>
                                    </div>
                                    <textarea
                                        value={sourceText}
                                        onChange={(e) => setSourceText(e.target.value)}
                                        placeholder="Type or paste text here..."
                                        className="w-full h-64 px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none"
                                    />
                                    <div className="flex gap-2 mt-2">
                                        <button
                                            onClick={() => setSourceText('')}
                                            className="text-sm px-3 py-1 text-gray-600 hover:text-gray-800"
                                        >
                                            üóëÔ∏è Clear
                                        </button>
                                    </div>
                                </div>

                                <div>
                                    <div className="flex justify-between items-center mb-2">
                                        <label className="text-sm font-semibold text-gray-700">
                                            Translation
                                        </label>
                                        {translatedText && (
                                            <button
                                                onClick={() => copyToClipboard(translatedText)}
                                                className="text-xs px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded"
                                            >
                                                üìã Copy
                                            </button>
                                        )}
                                    </div>
                                    <div className="w-full h-64 px-4 py-3 border-2 border-gray-200 rounded-lg bg-gray-50 overflow-y-auto">
                                        {isTranslating ? (
                                            <div className="flex items-center justify-center h-full">
                                                <div className="flex space-x-2">
                                                    <div className="w-3 h-3 bg-purple-500 rounded-full animate-bounce"></div>
                                                    <div className="w-3 h-3 bg-pink-500 rounded-full animate-bounce" style={{animationDelay: '0.2s'}}></div>
                                                    <div className="w-3 h-3 bg-purple-500 rounded-full animate-bounce" style={{animationDelay: '0.4s'}}></div>
                                                </div>
                                            </div>
                                        ) : (
                                            <p className="text-gray-700 whitespace-pre-wrap">{translatedText || 'Translation will appear here...'}</p>
                                        )}
                                    </div>
                                </div>
                            </div>

                            <div className="flex gap-3 mt-6">
                                <button
                                    onClick={handleTranslate}
                                    disabled={!sourceText.trim() || isTranslating}
                                    className="flex-1 px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg font-semibold hover:shadow-lg transition disabled:opacity-50 disabled:cursor-not-allowed"
                                >
                                    {isTranslating ? 'üîÑ Translating...' : 'üåç Translate'}
                                </button>
                            </div>

                            <div className="mt-4 p-4 bg-blue-50 rounded-lg">
                                <p className="text-sm text-gray-700">
                                    üí° <strong>Tip:</strong> Mendukung 16+ bahasa! Gunakan Auto Detect untuk deteksi bahasa otomatis.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // ============================================
        // ADD SCHEDULE MODAL
        // ============================================
        
        function AddScheduleModal({ isOpen, onClose, onAdd, existingSchedules }) {
            const [formData, setFormData] = useState({
                title: '',
                date: getCurrentDate().isoDate,
                time: '09:00',
                duration: 60,
                description: ''
            });
            const [conflicts, setConflicts] = useState([]);

            useEffect(() => {
                if (isOpen) {
                    checkConflicts();
                }
            }, [formData.date, formData.time, formData.duration, isOpen]);

            const checkConflicts = () => {
                const newStart = timeToMinutes(formData.time);
                const newEnd = newStart + formData.duration;
                
                const foundConflicts = existingSchedules.filter(s => {
                    if (new Date(s.date).toDateString() !== new Date(formData.date).toDateString()) {
                        return false;
                    }
                    
                    const scheduleStart = timeToMinutes(s.time);
                    const scheduleEnd = scheduleStart + (s.duration || 60);
                    
                    return (newStart < scheduleEnd && newEnd > scheduleStart);
                });

                setConflicts(foundConflicts);
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (formData.title.trim() && conflicts.length === 0) {
                    onAdd(formData);
                    setFormData({
                        title: '',
                        date: getCurrentDate().isoDate,
                        time: '09:00',
                        duration: 60,
                        description: ''
                    });
                    onClose();
                }
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto">
                        <div className="sticky top-0 bg-gradient-to-r from-cyan-500 to-blue-600 text-white p-6 rounded-t-2xl">
                            <div className="flex items-center justify-between">
                                <h2 className="text-2xl font-bold flex items-center gap-2">
                                    üìÖ Tambah Jadwal
                                </h2>
                                <button onClick={onClose} className="text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2">
                                    ‚úï
                                </button>
                            </div>
                        </div>

                        <form onSubmit={handleSubmit} className="p-6 space-y-4">
                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                    üìù Judul Acara *
                                </label>
                                <input
                                    type="text"
                                    value={formData.title}
                                    onChange={(e) => setFormData({...formData, title: e.target.value})}
                                    placeholder="Contoh: Meeting dengan Tim"
                                    className="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500"
                                    required
                                />
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        üìÜ Tanggal *
                                    </label>
                                    <input
                                        type="date"
                                        value={formData.date}
                                        onChange={(e) => setFormData({...formData, date: e.target.value})}
                                        className="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        üïê Waktu *
                                    </label>
                                    <input
                                        type="time"
                                        value={formData.time}
                                        onChange={(e) => setFormData({...formData, time: e.target.value})}
                                        className="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500"
                                        required
                                    />
                                </div>
                            </div>

                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                    ‚è±Ô∏è Durasi (menit)
                                </label>
                                <select
                                    value={formData.duration}
                                    onChange={(e) => setFormData({...formData, duration: parseInt(e.target.value)})}
                                    className="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500"
                                >
                                    <option value={15}>15 menit</option>
                                    <option value={30}>30 menit</option>
                                    <option value={45}>45 menit</option>
                                    <option value={60}>1 jam</option>
                                    <option value={90}>1.5 jam</option>
                                    <option value={120}>2 jam</option>
                                    <option value={180}>3 jam</option>
                                </select>
                            </div>

                            <div>
                                <label className="block text-sm font-semibold text-gray-700 mb-2">
                                    üìÑ Deskripsi (opsional)
                                </label>
                                <textarea
                                    value={formData.description}
                                    onChange={(e) => setFormData({...formData, description: e.target.value})}
                                    placeholder="Tambahkan catatan atau detail acara..."
                                    rows="3"
                                    className="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none"
                                />
                            </div>

                            {conflicts.length > 0 && (
                                <div className="bg-red-50 border-2 border-red-200 rounded-lg p-4">
                                    <p className="text-red-700 font-semibold mb-2">‚ö†Ô∏è Jadwal Bentrok!</p>
                                    <div className="space-y-1">
                                        {conflicts.map((c, i) => (
                                            <p key={i} className="text-sm text-red-600">
                                                ‚Ä¢ {c.time} - {c.title} ({c.duration} menit)
                                            </p>
                                        ))}
                                    </div>
                                </div>
                            )}

                            <div className="flex gap-3 pt-4">
                                <button
                                    type="button"
                                    onClick={onClose}
                                    className="flex-1 px-6 py-3 border-2 border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-50 transition"
                                >
                                    Batal
                                </button>
                                <button
                                    type="submit"
                                    disabled={!formData.title.trim() || conflicts.length > 0}
                                    className="flex-1 px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-lg font-semibold hover:shadow-lg transition disabled:opacity-50 disabled:cursor-not-allowed"
                                >
                                    ‚úÖ Tambahkan
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // ============================================
        // GROQ AI
        // ============================================
        
        const askGroqAI = async (userMessage) => {
            try {
                const systemMessage = `Kamu adalah Kai, asisten AI yang ramah dan helpful untuk kehidupan sehari-hari.

KEPRIBADIAN:
- Ramah, calm, dan approachable seperti suara ombak laut üåä
- Supportive dan encouraging
- Gunakan emoji dengan natural (tapi jangan berlebihan)
- Bahasa Indonesia yang casual tapi sopan
- Jangan gunakan formatting markdown seperti ** atau __ untuk bold/italic

TUGAS UTAMA:
1. MATEMATIKA: Bantu hitung, jelaskan rumus, solve persamaan dengan step-by-step
2. PENERJEMAHAN: Bantu translate berbagai bahasa (sarankan pakai fitur Translator untuk hasil terbaik)
3. WAKTU: Berikan info waktu dan tanggal
4. UMUM: Jawab pertanyaan sehari-hari dengan helpful

FOKUS MATEMATIKA:
- Jelaskan rumus dengan jelas dan contoh
- Berikan step-by-step solution yang mudah dipahami
- Support: aritmatika, aljabar, geometri, kalkulus, statistik, persentase, dll
- Format angka dengan rapi (gunakan separator untuk ribuan jika perlu)
- Gunakan emoji üßÆ üìê üìä ‚ûó untuk matematika

PENERJEMAHAN:
- Jika user minta translate, jawab dengan terjemahan singkat
- Sarankan menggunakan fitur Translator (tombol üåç) untuk pengalaman yang lebih baik
- Mendukung 16+ bahasa

INFO SISTEM:
- Kamu menggunakan Groq AI dengan model Llama 3.3 (70B parameter)
- Waktu sekarang: ${getCurrentTime().time}, ${getCurrentDate().date}

PENTING: Jangan gunakan ** atau __ untuk formatting. Tulis text biasa saja.

Selalu ramah, helpful, dan jadikan interaksi menyenangkan! üòä`;

                const response = await fetch(GROQ_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${GROQ_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'llama-3.3-70b-versatile',
                        messages: [
                            { role: 'system', content: systemMessage },
                            { role: 'user', content: userMessage }
                        ],
                        temperature: 0.7,
                        max_tokens: 1500
                    })
                });

                if (!response.ok) throw new Error('Gagal terhubung ke Groq AI');

                const data = await response.json();
                return {
                    success: true,
                    message: data.choices[0].message.content
                };
            } catch (error) {
                return {
                    success: false,
                    error: error.message
                };
            }
        };

        // ============================================
        // MAIN COMPONENT
        // ============================================
        
        function ChatbotApp() {
            const [messages, setMessages] = useState([
                {
                    type: 'bot',
                    text: `üëã Halo! Saya Kai üåä\n\nAI companion Anda untuk kehidupan sehari-hari!\n\nFITUR UTAMA:\n‚è∞ Info waktu & tanggal real-time\nüìÖ Manajemen jadwal pintar\nüåç Penerjemah 16+ bahasa (BARU!)\nüßÆ Matematika & perhitungan\nüí¨ Jawab pertanyaan umum\n\nCOBA KETIK:\n‚Ä¢ "Lihat jadwal"\n‚Ä¢ "Translate: Hello world to Indonesian"\n‚Ä¢ "Hitung 15% dari 350.000"\n\n‚ö° Powered by Groq AI (Llama 3.3 - 70B)\n\nKetik "bantuan" untuk panduan lengkap! üòä`,
                    time: new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' })
                }
            ]);
            const [inputText, setInputText] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [schedules, setSchedules] = useState([]);
            const [showAddModal, setShowAddModal] = useState(false);
            const [showTranslator, setShowTranslator] = useState(false);
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            const addSchedule = (scheduleData) => {
                const newSchedule = {
                    id: Date.now().toString(),
                    ...scheduleData,
                    createdAt: new Date().toISOString()
                };
                
                setSchedules(prev => [...prev, newSchedule]);
                
                const dateStr = new Date(newSchedule.date).toLocaleDateString('id-ID', { 
                    weekday: 'long', day: 'numeric', month: 'long' 
                });
                
                addBotMessage(
                    `‚úÖ JADWAL BERHASIL DITAMBAHKAN!\n\n` +
                    `üìù Judul: ${newSchedule.title}\n` +
                    `üìÖ Tanggal: ${dateStr}\n` +
                    `üïê Waktu: ${newSchedule.time}\n` +
                    `‚è±Ô∏è Durasi: ${newSchedule.duration} menit\n` +
                    `${newSchedule.description ? `üìÑ Deskripsi: ${newSchedule.description}\n` : ''}` +
                    `\nüîñ ID: ${newSchedule.id}\n\n` +
                    `Ketik "jadwal" untuk lihat semua jadwal.`
                );
            };

            const deleteSchedule = (id) => {
                const found = schedules.find(s => s.id === id);
                if (found) {
                    setSchedules(prev => prev.filter(s => s.id !== id));
                    return found;
                }
                return null;
            };

            const getTodaySchedules = () => {
                const today = new Date().toDateString();
                
                return schedules.filter(s => {
                    const scheduleDate = new Date(s.date).toDateString();
                    return scheduleDate === today;
                }).map(s => ({
                    ...s,
                    status: getScheduleStatus(s)
                })).sort((a, b) => timeToMinutes(a.time) - timeToMinutes(b.time));
            };

            const getUpcomingSchedules = () => {
                const now = new Date();
                
                return schedules.filter(s => {
                    const scheduleDate = new Date(s.date);
                    return scheduleDate >= now;
                }).map(s => ({
                    ...s,
                    status: getScheduleStatus(s)
                })).sort((a, b) => new Date(a.date) - new Date(b.date));
            };

            const addBotMessage = (text) => {
                setMessages(prev => [...prev, {
                    type: 'bot',
                    text,
                    time: new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' })
                }]);
            };

            const handleCommand = async (input) => {
                const lower = input.toLowerCase();

                // TRANSLATE
                if (lower.match(/translate|terjemah|arti|artinya/)) {
                    setShowTranslator(true);
                    return {
                        handled: true,
                        response: `üåç TRANSLATOR DIBUKA!\n\nFitur translator telah dibuka di modal terpisah.\n\nFITUR:\n‚úÖ 16+ bahasa tersedia\n‚úÖ Auto detect bahasa\n‚úÖ Copy hasil terjemahan\n‚úÖ Swap bahasa cepat\n\nüí° Untuk hasil terbaik, gunakan modal Translator!\n\nAtau tanya saya langsung untuk terjemahan cepat! üòä`
                    };
                }

                // WAKTU
                if (lower.match(/^(jam berapa|waktu|pukul berapa)(\?)?$/)) {
                    const { time, greeting } = getCurrentTime();
                    return {
                        handled: true,
                        response: `‚è∞ WAKTU SAAT INI\n\nPukul ${time}\n\nSelamat ${greeting}! üòä`
                    };
                }

                // TANGGAL
                if (lower.match(/^(tanggal berapa|hari ini|hari apa)(\?)?$/)) {
                    const { date } = getCurrentDate();
                    return {
                        handled: true,
                        response: `üìÖ TANGGAL HARI INI\n\n${date}\n\nSemoga hari Anda produktif! üí™`
                    };
                }

                // LIHAT JADWAL
                if (lower.match(/^(lihat jadwal|jadwal|jadwal hari ini|cek jadwal|schedule)(\?)?$/)) {
                    const today = getTodaySchedules();
                    const upcoming = getUpcomingSchedules();

                    if (today.length === 0 && upcoming.length === 0) {
                        return {
                            handled: true,
                            response: `üìÖ JADWAL KOSONG\n\nBelum ada jadwal tersimpan.\n\nüí° Klik tombol "‚ûï Tambah Jadwal" untuk menambahkan jadwal baru!`
                        };
                    }

                    let response = '';

                    if (today.length > 0) {
                        const ongoing = today.filter(s => s.status === 'ongoing');
                        const upcomingToday = today.filter(s => s.status === 'upcoming');
                        const expired = today.filter(s => s.status === 'expired');

                        response += `üìÖ JADWAL HARI INI (${today.length} jadwal)\n\n`;

                        if (ongoing.length > 0) {
                            response += `üî¥ SEDANG BERLANGSUNG:\n`;
                            ongoing.forEach((s, i) => {
                                response += `${i + 1}. üïê ${s.time} - ${s.title}\n`;
                                if (s.description) response += `   üìù ${s.description}\n`;
                                if (s.duration) response += `   ‚è±Ô∏è Durasi: ${s.duration} menit\n`;
                                response += `   üóëÔ∏è ID: ${s.id}\n\n`;
                            });
                        }

                        if (upcomingToday.length > 0) {
                            response += `üü¢ AKAN DATANG:\n`;
                            upcomingToday.forEach((s, i) => {
                                response += `${i + 1}. üïê ${s.time} - ${s.title}\n`;
                                if (s.description) response += `   üìù ${s.description}\n`;
                                if (s.duration) response += `   ‚è±Ô∏è Durasi: ${s.duration} menit\n`;
                                response += `   üóëÔ∏è ID: ${s.id}\n\n`;
                            });
                        }

                        if (expired.length > 0) {
                            response += `‚ö™ SUDAH BERLALU:\n`;
                            expired.forEach((s, i) => {
                                response += `${i + 1}. üïê ${s.time} - ${s.title} ‚úì\n`;
                                if (s.description) response += `   üìù ${s.description}\n`;
                                response += `   üóëÔ∏è ID: ${s.id}\n\n`;
                            });
                        }
                    }

                    const otherDays = upcoming.filter(s => 
                        new Date(s.date).toDateString() !== new Date().toDateString()
                    );

                    if (otherDays.length > 0) {
                        response += `\nüìÜ JADWAL MENDATANG (${Math.min(otherDays.length, 5)} dari ${otherDays.length})\n\n`;
                        otherDays.slice(0, 5).forEach((s, i) => {
                            const schedDate = new Date(s.date).toLocaleDateString('id-ID', { 
                                weekday: 'short', 
                                day: 'numeric', 
                                month: 'short' 
                            });
                            response += `${i + 1}. ${schedDate} ${s.time} - ${s.title}\n`;
                        });
                    }

                    response += `\nüí° Hapus: "hapus jadwal [ID]"`;
                    
                    return {
                        handled: true,
                        response
                    };
                }

                // HAPUS JADWAL
                const deleteMatch = lower.match(/hapus jadwal (.+)/);
                if (deleteMatch) {
                    const id = deleteMatch[1].trim();
                    const found = deleteSchedule(id);
                    
                    if (found) {
                        return {
                            handled: true,
                            response: `‚úÖ JADWAL DIHAPUS\n\n"${found.title}" telah dihapus dari jadwal Anda.\n\nKetik "jadwal" untuk lihat jadwal lainnya.`
                        };
                    } else {
                        return {
                            handled: true,
                            response: `‚ùå Jadwal dengan ID "${id}" tidak ditemukan.\n\nKetik "jadwal" untuk lihat semua ID.`
                        };
                    }
                }

                // TAMBAH JADWAL
                if (lower.match(/tambah jadwal|buat jadwal|jadwal baru/)) {
                    setShowAddModal(true);
                    return {
                        handled: true,
                        response: `üìÖ Form tambah jadwal telah dibuka!\n\nSilakan isi detail jadwal Anda di form yang muncul.`
                    };
                }

                // SIAPA KAMU
                if (lower.match(/siapa kamu|siapa anda|kamu siapa|tentang kai|apa itu kai/)) {
                    return {
                        handled: true,
                        response: `üëã Halo! Saya Kai üåä\n\n` +
                                 `Saya adalah AI companion Anda untuk kehidupan sehari-hari!\n\n` +
                                 `YANG BISA SAYA BANTU:\n` +
                                 `üßÆ Matematika & perhitungan\n` +
                                 `üìÖ Manajemen jadwal pintar\n` +
                                 `üåç Penerjemah 16+ bahasa (BARU!)\n` +
                                 `‚è∞ Info waktu & tanggal\n` +
                                 `üí¨ Obrolan & pertanyaan umum\n\n` +
                                 `TEKNOLOGI:\n` +
                                 `‚ö° Powered by Groq AI\n` +
                                 `ü§ñ Model: Llama 3.3 (70B)\n` +
                                 `üöÄ Super cepat & akurat\n\n` +
                                 `Senang bisa membantu Anda! üòä`
                    };
                }

                // BANTUAN
                if (lower.match(/^(bantuan|help|perintah)(\?)?$/)) {
                    return {
                        handled: true,
                        response: `üìã PANDUAN PENGGUNAAN KAI\n\n` +
                                 `‚è∞ WAKTU & TANGGAL:\n` +
                                 `‚Ä¢ "Jam berapa?"\n` +
                                 `‚Ä¢ "Tanggal berapa?"\n\n` +
                                 `üìÖ JADWAL PINTAR:\n` +
                                 `‚Ä¢ Klik tombol "‚ûï Tambah Jadwal"\n` +
                                 `‚Ä¢ "Lihat jadwal"\n` +
                                 `‚Ä¢ "Hapus jadwal [ID]"\n\n` +
                                 `üåç TRANSLATOR (BARU!):\n` +
                                 `‚Ä¢ Klik tombol "üåç Translator"\n` +
                                 `‚Ä¢ Atau ketik: "Translate..."\n` +
                                 `‚Ä¢ Mendukung 16+ bahasa\n` +
                                 `‚Ä¢ Auto detect bahasa\n\n` +
                                 `üßÆ MATEMATIKA:\n` +
                                 `‚Ä¢ "Hitung 15% dari 250.000"\n` +
                                 `‚Ä¢ "Jelaskan rumus pythagoras"\n` +
                                 `‚Ä¢ "Solve: 2x + 5 = 15"\n\n` +
                                 `üí¨ LAINNYA:\n` +
                                 `‚Ä¢ "Siapa kamu?"\n` +
                                 `‚Ä¢ Tanya apapun!\n\n` +
                                 `‚ö° Powered by Groq AI (Llama 3.3)`
                    };
                }

                // SAPAAN
                if (lower.match(/^(halo|hai|hi|hello|hey)(!)?$/)) {
                    const { greeting } = getCurrentTime();
                    return {
                        handled: true,
                        response: `Selamat ${greeting}! üëã\n\n` +
                                 `Saya Kai, AI companion Anda! üåä\n\n` +
                                 `Saya bisa bantu dengan:\n` +
                                 `‚è∞ Info waktu & tanggal\n` +
                                 `üìÖ Kelola jadwal\n` +
                                 `üåç Terjemahkan bahasa (16+ bahasa!)\n` +
                                 `üßÆ Matematika & perhitungan\n` +
                                 `üí¨ Pertanyaan sehari-hari\n\n` +
                                 `Ada yang bisa saya bantu hari ini? üòä`
                    };
                }

                return { handled: false };
            };

            const handleSendMessage = async () => {
                if (inputText.trim() === '' || isLoading) return;

                const userMessage = {
                    type: 'user',
                    text: inputText,
                    time: new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' })
                };

                setMessages(prev => [...prev, userMessage]);
                const userInput = inputText;
                setInputText('');
                setIsLoading(true);

                try {
                    const cmdResponse = await handleCommand(userInput);
                    
                    if (cmdResponse.handled) {
                        setTimeout(() => {
                            addBotMessage(cmdResponse.response);
                            setIsLoading(false);
                        }, 300);
                    } else {
                        const aiResponse = await askGroqAI(userInput);
                        
                        if (aiResponse.success) {
                            addBotMessage(aiResponse.message);
                        } else {
                            addBotMessage(`‚ùå Maaf, terjadi kesalahan.\n\n${aiResponse.error}\n\nSilakan coba lagi.`);
                        }
                        
                        setIsLoading(false);
                    }
                } catch (error) {
                    addBotMessage(`‚ùå Error: ${error.message}`);
                    setIsLoading(false);
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };

            const clearHistory = () => {
                setMessages([{
                    type: 'bot',
                    text: 'üîÑ Chat direset!\n\nHalo lagi! Ada yang bisa saya bantu? üòä',
                    time: new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' })
                }]);
            };

            return (
                <div className="flex flex-col h-screen bg-gradient-to-br from-cyan-50 via-blue-50 to-indigo-50">
                    <div className="bg-white shadow-lg px-6 py-4 border-b-2 border-cyan-200">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center space-x-4">
                                <div className="relative">
                                    <div className="bg-gradient-to-br from-cyan-500 to-blue-600 p-3 rounded-2xl shadow-lg">
                                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" strokeWidth="2">
                                            <path d="M3 7.8L7.5 14 12 7.8 16.5 14 21 7.8"></path>
                                            <path d="M3 16.8L7.5 23 12 16.8 16.5 23 21 16.8"></path>
                                        </svg>
                                    </div>
                                    <div className="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white animate-pulse"></div>
                                </div>
                                <div>
                                    <h1 className="text-2xl font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent">Kai üåä</h1>
                                    <p className="text-xs text-gray-500">Your Daily AI Companion</p>
                                </div>
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setShowTranslator(true)}
                                    className="px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-600 hover:shadow-lg text-white rounded-lg transition text-sm font-medium flex items-center gap-2"
                                >
                                    üåç Translator
                                </button>
                                <button
                                    onClick={() => setShowAddModal(true)}
                                    className="px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 hover:shadow-lg text-white rounded-lg transition text-sm font-medium flex items-center gap-2"
                                >
                                    ‚ûï Jadwal
                                </button>
                                <button
                                    onClick={clearHistory}
                                    className="px-4 py-2 bg-cyan-100 hover:bg-cyan-200 rounded-lg transition text-cyan-700 text-sm font-medium"
                                >
                                    Reset
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="flex-1 overflow-y-auto px-4 py-6 space-y-4">
                        {messages.map((message, index) => (
                            <div
                                key={index}
                                className={`flex ${message.type === 'user' ? 'justify-end' : 'justify-start'} animate-fade-in`}
                            >
                                <div
                                    className={`max-w-xs md:max-w-md lg:max-w-lg px-5 py-3 rounded-2xl shadow-md ${
                                        message.type === 'user'
                                            ? 'bg-gradient-to-br from-cyan-500 to-blue-600 text-white rounded-br-none'
                                            : 'bg-white text-gray-800 rounded-bl-none border border-cyan-100'
                                    }`}
                                >
                                    <p className="text-sm whitespace-pre-line leading-relaxed">{message.text}</p>
                                    <p className={`text-xs mt-2 ${message.type === 'user' ? 'text-cyan-100' : 'text-gray-400'}`}>
                                        {message.time}
                                    </p>
                                </div>
                            </div>
                        ))}
                        
                        {isLoading && (
                            <div className="flex justify-start animate-fade-in">
                                <div className="bg-white px-5 py-4 rounded-2xl shadow-md border border-cyan-100">
                                    <div className="flex space-x-2 items-center">
                                        <div className="w-2.5 h-2.5 bg-cyan-500 rounded-full animate-bounce"></div>
                                        <div className="w-2.5 h-2.5 bg-blue-600 rounded-full animate-bounce" style={{animationDelay: '0.2s'}}></div>
                                        <div className="w-2.5 h-2.5 bg-cyan-500 rounded-full animate-bounce" style={{animationDelay: '0.4s'}}></div>
                                        <span className="text-xs text-gray-500 ml-2">Kai sedang mengetik...</span>
                                    </div>
                                </div>
                            </div>
                        )}
                        
                        <div ref={messagesEndRef} />
                    </div>

                    {messages.length === 1 && (
                        <div className="px-4 pb-2">
                            <div className="flex gap-2 overflow-x-auto pb-2">
                                {[
                                    { icon: 'üåç', text: 'Translator', action: 'translator' },
                                    { icon: 'üìÖ', text: 'Lihat jadwal', action: 'text' },
                                    { icon: 'üßÆ', text: 'Hitung 20% dari 150.000', action: 'text' },
                                    { icon: '‚è∞', text: 'Jam berapa?', action: 'text' }
                                ].map((item, i) => (
                                    <button
                                        key={i}
                                        onClick={() => {
                                            if (item.action === 'translator') {
                                                setShowTranslator(true);
                                            } else {
                                                setInputText(item.text);
                                            }
                                        }}
                                        className="px-4 py-2 bg-white hover:bg-cyan-50 border border-cyan-200 rounded-xl text-sm font-medium text-gray-700 hover:text-cyan-600 transition whitespace-nowrap shadow-sm flex items-center gap-2"
                                    >
                                        <span>{item.icon}</span>
                                        <span>{item.text}</span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    )}

                    <div className="bg-white border-t-2 border-cyan-200 px-4 py-4 shadow-lg">
                        <div className="flex items-end space-x-3">
                            <textarea
                                value={inputText}
                                onChange={(e) => setInputText(e.target.value)}
                                onKeyPress={handleKeyPress}
                                placeholder="Ketik pesan untuk Kai..."
                                disabled={isLoading}
                                className="flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent resize-none disabled:bg-gray-50 disabled:text-gray-400 transition"
                                rows="1"
                                style={{ minHeight: '52px', maxHeight: '120px' }}
                            />
                            <button
                                onClick={handleSendMessage}
                                disabled={isLoading || !inputText.trim()}
                                className="bg-gradient-to-br from-cyan-500 to-blue-600 text-white p-3.5 rounded-xl hover:shadow-lg hover:scale-105 transition-all disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed"
                            >
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                    <line x1="22" y1="2" x2="11" y2="13"></line>
                                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                                </svg>
                            </button>
                        </div>
                        <p className="text-xs text-gray-400 mt-2 text-center flex items-center justify-center gap-2 flex-wrap">
                            <span>‚ö° Powered by</span>
                            <span className="font-semibold text-cyan-600">Groq AI</span>
                            <span>‚Ä¢</span>
                            <span className="font-medium">Llama 3.3 (70B)</span>
                            <span>‚Ä¢</span>
                            <span>üåç 16+ Languages</span>
                        </p>
                    </div>

                    <AddScheduleModal
                        isOpen={showAddModal}
                        onClose={() => setShowAddModal(false)}
                        onAdd={addSchedule}
                        existingSchedules={schedules}
                    />

                    <TranslatorModal
                        isOpen={showTranslator}
                        onClose={() => setShowTranslator(false)}
                    />
                </div>
            );
        }

        ReactDOM.render(<ChatbotApp />, document.getElementById('root'));
    </script>

    <style>
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fade-in 0.3s ease-out; }
        textarea::-webkit-scrollbar { width: 4px; }
        textarea::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 2px; }
    </style>
</body>
</html>
